# GARAMe MANAGER 사용자 매뉴얼
## 버전 1.9.1

---

**문서 정보**
- 작성일: 2025-11-06
- 버전: 1.9.1
- 대상: 관리자, 운영자, 사용자
- 문서 코드: GARAME-MAN-v1.9.1

---

## 📋 목차

### 1부. 시작하기
1. [제품 소개](#1-제품-소개)
2. [시스템 요구사항](#2-시스템-요구사항)
3. [설치 방법](#3-설치-방법)
4. [첫 실행](#4-첫-실행)

### 2부. 기본 사용법
5. [메인 화면 구성](#5-메인-화면-구성)
6. [센서 모니터링](#6-센서-모니터링)
7. [거울보기 모드](#7-거울보기-모드)
8. [안전교육 관리](#8-안전교육-관리)

### 3부. 고급 기능
9. [얼굴 인식 시스템](#9-얼굴-인식-시스템)
10. [보호구 감지](#10-보호구-감지)
11. [출입 관리](#11-출입-관리)
12. [도면 뷰](#12-도면-뷰)

### 4부. 관리자 기능
13. [환경 설정](#13-환경-설정)
14. [데이터 관리](#14-데이터-관리)
15. [백업 및 복원](#15-백업-및-복원)
16. [자동 시작 설정](#16-자동-시작-설정)

### 5부. 문제 해결
17. [일반적인 문제](#17-일반적인-문제)
18. [오류 메시지](#18-오류-메시지)
19. [FAQ](#19-faq)
20. [기술 지원](#20-기술-지원)

### 부록
- [A. 단축키 목록](#부록-a-단축키-목록)
- [B. 파일 구조](#부록-b-파일-구조)
- [C. 업데이트 이력](#부록-c-업데이트-이력)

---

# 1부. 시작하기

## 1. 제품 소개

### 1.1 GARAMe MANAGER란?

**GARAMe MANAGER**는 산업 현장의 안전을 지키는 AI 기반 통합 안전 관리 시스템입니다.

#### 🎯 핵심 가치
- **실시간 모니터링**: 9종 환경 센서 데이터 24시간 감시
- **AI 안전 관리**: 얼굴 인식 + 보호구 착용 자동 감지
- **완전 자동화**: 출입 기록, 안전 교육 이력 자동 기록
- **규정 준수 보장**: 안전 규정 위반 즉시 경고

### 1.2 주요 기능 개요

#### 📊 센서 모니터링 (실시간)
```
9종 센서 동시 모니터링
├─ 가스: CO₂, O₂, H₂S, CO, LEL
├─ 환경: 온도, 습도, 연기
└─ 안전: 누수 감지
```

**5단계 경보 시스템**:
- 🟢 정상 (Normal)
- 🔵 관심 (Attention)
- 🟡 주의 (Caution)
- 🟠 경보 (Alert)
- 🔴 심각 (Critical)

#### 👤 얼굴 인식 시스템
- **자동 식별**: 등록된 직원 실시간 인식
- **정보 표시**: 이름, 사원번호, 부서 표시
- **출입 기록**: 출입 시간 자동 저장

#### 🦺 보호구 착용 감지
- ✅ 안전모 (색상 구분)
- ✅ 보안경/안경
- ✅ 장갑
- ✅ 안전화
- ✅ 작업복 (색상)

#### 📚 안전 교육 관리
- 포스터 기반 교육
- 손글씨 서명 OCR 인식
- 교육 이력 자동 기록
- 사진 증빙 저장

### 1.3 v1.9.1 신규 기능

#### 🆕 주요 개선사항
- **배경 학습 기능** (NEW)
  - 10장 사진 촬영 기반 배경 학습
  - 3초 카운트다운
  - 썸네일 미리보기

- **한글 입력 개선**
  - xdotool 기반 조합 완성
  - 가상 키보드 한글 지원

- **와치독 안정성 강화**
  - 자동 재시작 기능
  - 트레이 아이콘 오류 수정

- **Cython 보안 빌드** (선택)
  - 소스코드 보호
  - 10-30% 성능 향상

자세한 변경 사항은 [VERSION_1.9.1_CHANGES.md](VERSION_1.9.1_CHANGES.md) 참조

---

## 2. 시스템 요구사항

### 2.1 하드웨어 요구사항

#### 최소 사양
- **CPU**: 듀얼코어 2.0 GHz
- **RAM**: 4GB
- **저장공간**: 50GB HDD
- **카메라**: 640x480 이상
- **네트워크**: 유선 LAN 100Mbps

#### 권장 사양
- **CPU**: 쿼드코어 2.5 GHz 이상
- **RAM**: 8GB 이상
- **저장공간**: 100GB SSD
- **카메라**: 1280x720 (HD) 이상
- **그래픽**: OpenGL 3.3 지원
- **네트워크**: 유선 LAN 1Gbps

#### 다중 카메라 모니터링
- **CPU**: 옥타코어 3.0 GHz 이상
- **RAM**: 16GB 이상
- **저장공간**: 256GB SSD
- **카메라**: 1920x1080 (Full HD) 이상
- **그래픽**: 전용 GPU 권장

### 2.2 소프트웨어 요구사항

#### 운영체제
- **Ubuntu 25.10** (Questing Quokka) - 권장
- Ubuntu 24.04 LTS
- Ubuntu 22.04 LTS

#### 필수 소프트웨어
- Python 3.10 이상
- Python 가상환경 (venv)
- 카메라 드라이버 (v4l-utils)
- 한글 폰트 (나눔 폰트)

### 2.3 네트워크 요구사항

#### 포트 사용
- **TCP 9000**: 센서 데이터 수신 (기본값)
- **TCP 5000**: 웹 인터페이스 (선택)

#### 방화벽 설정
```bash
sudo ufw allow 9000/tcp  # 센서 연결
sudo ufw allow 5000/tcp  # 웹 인터페이스 (선택)
```

---

## 3. 설치 방법

### 3.1 빠른 설치 (3단계)

#### 1단계: 파일 준비
```bash
cd ~/Desktop/프로그램/manager/1.9.1
```

#### 2단계: 설치 실행
```bash
chmod +x install.sh run.sh
./install.sh
```

**질문 응답**:
- 온라인 설치를 진행하시겠습니까? → `y`
- 시스템 설정을 최적화하시겠습니까? → `y`
- 자동 시작 설정을 하시겠습니까? → `y` (권장)

#### 3단계: 실행
```bash
./run.sh
```

### 3.2 상세 설치 과정

설치 스크립트는 다음 작업을 자동으로 수행합니다:

1. **시스템 패키지 설치** (자동)
   - Python, OpenCV, 빌드 도구
   - 카메라 드라이버, 멀티미디어 라이브러리

2. **한글 폰트 설치** (자동)
   - 나눔고딕, 나눔명조
   - 나눔바른고딕, 나눔스퀘어

3. **Python 가상환경 생성** (자동)
   - `~/venvs/garame` 디렉토리
   - 독립적인 Python 환경

4. **Python 패키지 설치** (자동)
   - OpenCV, Pillow, matplotlib
   - EasyOCR, face-recognition
   - 기타 의존성 패키지 (200+)

5. **설정 파일 생성** (자동)
   - `config.conf` (환경 설정)
   - `standard_defaults.conf` (기본값)

6. **시스템 최적화** (선택)
   - 화면 보호기 비활성화
   - 절전 모드 비활성화
   - 시스템 알림 비활성화

7. **자동 시작 설정** (선택)
   - 부팅 시 자동 실행
   - 로그인 시 자동 실행

### 3.3 오프라인 설치

인터넷 연결이 없는 환경에서 설치하려면:

1. **온라인 환경에서 패키지 다운로드**
```bash
./download_all_wheels.sh
```

2. **오프라인 환경으로 전송**
```bash
# USB 또는 네트워크로 전체 디렉토리 복사
```

3. **오프라인 설치 실행**
```bash
./install.sh
# "온라인 설치를 진행하시겠습니까?" → n
```

자세한 내용은 [OFFLINE_INSTALLATION_GUIDE.md](OFFLINE_INSTALLATION_GUIDE.md) 참조

### 3.4 설치 확인

설치가 완료되면 다음을 확인하세요:

#### 가상환경 확인
```bash
source ~/venvs/garame/bin/activate
python --version  # Python 3.10 이상
```

#### 의존성 확인
```bash
python check_dependencies.py
```

#### 카메라 확인
```bash
ls -l /dev/video*  # 카메라 장치 확인
```

---

## 4. 첫 실행

### 4.1 프로그램 시작

#### 기본 실행
```bash
cd ~/Desktop/프로그램/manager/1.9.1
./run.sh
```

#### Watchdog 모드 (권장)
```bash
./run.sh -w
```
- 프로그램 크래시 시 자동 재시작
- 24시간 무중단 운영에 적합

#### 백그라운드 모드
```bash
./run.sh -b
```
- 터미널 없이 백그라운드 실행
- 로그는 `logs/` 디렉토리에 저장

#### 디버그 모드
```bash
./run.sh -d
```
- 상세한 로그 출력
- 문제 해결 시 사용

### 4.2 초기 화면

프로그램이 시작되면 **메인 패널**이 표시됩니다:

```
┌─────────────────────────────────────────┐
│  GARAMe MANAGER v1.9.1                  │
├─────────────────────────────────────────┤
│  [센서 모니터링]  [거울보기]  [안전교육] │
│  [도면 뷰]       [설정]      [종료]     │
└─────────────────────────────────────────┘
```

### 4.3 초기 설정

#### 1. 카메라 설정
메인 패널 → **설정** → **카메라 설정**

- 카메라 선택: 사용할 카메라 선택 (0, 1, 2...)
- 해상도: 640x480, 1280x720, 1920x1080
- 상하 반전: 필요시 체크
- 좌우 반전: 필요시 체크

#### 2. 센서 설정
메인 패널 → **설정** → **센서 설정**

- TCP 포트: 9000 (기본값)
- 센서 ID: 센서별 식별자
- 경보 임계치: 5단계별 설정

#### 3. 얼굴 인식 설정
메인 패널 → **설정** → **얼굴 인식**

- 얼굴 인식 활성화: 체크
- 신뢰도 임계값: 0.5 ~ 0.9 (기본 0.6)
- 얼굴 크기 최소값: 조정 가능

### 4.4 첫 직원 등록

#### 얼굴 등록 절차

1. **거울보기 모드 진입**
   ```
   메인 패널 → [거울보기]
   ```

2. **관리자 모드 활성화**
   ```
   거울보기 화면 → 우클릭 → [관리자 모드 On]
   비밀번호 입력: admin (기본값)
   ```

3. **얼굴 등록**
   ```
   관리자 모드 → 상단 [얼굴 등록]

   정보 입력:
   - 이름: 홍길동
   - 사원번호: 2025001
   - 부서: 생산부

   [촬영 시작] 클릭
   → 10장 자동 촬영
   → [등록 완료] 클릭
   ```

4. **등록 확인**
   ```
   얼굴을 카메라에 비추면:
   "홍길동 (2025001)" 표시
   ```

---

# 2부. 기본 사용법

## 5. 메인 화면 구성

### 5.1 메인 패널

```
┌──────────────────────────────────────────────────┐
│          GARAMe MANAGER v1.9.1                   │
│          통합 안전 관리 시스템                    │
├──────────────────────────────────────────────────┤
│                                                  │
│   ┌────────────┐  ┌────────────┐  ┌────────────┐│
│   │ 센서       │  │ 거울보기    │  │ 안전교육   ││
│   │ 모니터링   │  │ Mirror View │  │ Education  ││
│   └────────────┘  └────────────┘  └────────────┘│
│                                                  │
│   ┌────────────┐  ┌────────────┐  ┌────────────┐│
│   │ 도면 뷰    │  │ 환경 설정   │  │ 종료       ││
│   │ Blueprint  │  │ Settings    │  │ Exit       ││
│   └────────────┘  └────────────┘  └────────────┘│
│                                                  │
├──────────────────────────────────────────────────┤
│  상태: 정상 동작 중 │ 센서: 연결됨 │ 시간: 14:30 │
└──────────────────────────────────────────────────┘
```

### 5.2 버튼 설명

| 버튼 | 기능 | 단축키 |
|------|------|--------|
| 센서 모니터링 | 9종 센서 실시간 모니터링 | F1 |
| 거울보기 | 거울 + 얼굴 인식 + 보호구 감지 | F2 |
| 안전교육 | 안전 교육 포스터 및 서명 관리 | F3 |
| 도면 뷰 | 센서 위치 도면 표시 | F4 |
| 환경 설정 | 프로그램 설정 | F5 |
| 종료 | 프로그램 종료 | ESC |

### 5.3 상태 표시줄

하단 상태 표시줄 정보:
- **상태**: 프로그램 동작 상태
- **센서**: 센서 연결 상태
- **시간**: 현재 시각

---

## 6. 센서 모니터링

### 6.1 센서 모니터링 화면

메인 패널 → **[센서 모니터링]** 클릭

#### 3x3 그리드 레이아웃
```
┌─────────┬─────────┬─────────┐
│  CO₂    │   O₂    │  H₂S    │
│  450ppm │ 20.9%   │  0ppm   │
│  🟢정상  │  🟢정상  │  🟢정상  │
├─────────┼─────────┼─────────┤
│   CO    │  LEL    │  연기   │
│  5ppm   │  0%     │  없음   │
│  🟢정상  │  🟢정상  │  🟢정상  │
├─────────┼─────────┼─────────┤
│  온도    │  습도   │  누수   │
│  23.5°C │  45%    │  없음   │
│  🟢정상  │  🟢정상  │  🟢정상  │
└─────────┴─────────┴─────────┘
```

### 6.2 센서별 상세 정보

각 센서 타일 클릭 시 상세 정보 표시:

#### CO₂ (이산화탄소)
- **현재값**: 450 ppm
- **경보 단계**:
  - 정상: < 1000 ppm 🟢
  - 관심: 1000-1500 ppm 🔵
  - 주의: 1500-2000 ppm 🟡
  - 경보: 2000-5000 ppm 🟠
  - 심각: > 5000 ppm 🔴
- **그래프**: 최근 1시간 추이
- **통계**: 최저/평균/최고값

#### O₂ (산소)
- **현재값**: 20.9 %
- **경보 단계**:
  - 심각: < 18% 🔴
  - 경보: 18-19% 🟠
  - 주의: 19-19.5% 🟡
  - 정상: 19.5-23% 🟢
  - 관심: > 23% 🔵

#### H₂S (황화수소)
- **현재값**: 0 ppm
- **경보 단계**:
  - 정상: 0 ppm 🟢
  - 관심: 1-5 ppm 🔵
  - 주의: 5-10 ppm 🟡
  - 경보: 10-20 ppm 🟠
  - 심각: > 20 ppm 🔴

### 6.3 실시간 그래프

센서 모니터링 화면 하단:
- **시계열 그래프**: 최근 1시간 데이터
- **자동 업데이트**: 1초마다 갱신
- **확대/축소**: 마우스 휠
- **이동**: 드래그

### 6.4 경보 알림

경보 발생 시:
1. **화면 강조**: 해당 센서 타일 깜빡임
2. **색상 변경**: 경보 레벨에 따른 색상
3. **소리 알림**: beep (설정에서 끄기 가능)
4. **로그 기록**: 자동 저장

---

## 7. 거울보기 모드

### 7.1 거울보기 화면

메인 패널 → **[거울보기]** 클릭

#### 화면 구성
```
┌─────────────────────────────────────────┐
│        거울보기 + 얼굴 인식              │
├─────────────────────────────────────────┤
│                                         │
│        [  카메라 화면  ]                │
│                                         │
│     👤 홍길동 (2025001)                 │
│                                         │
│     ✅ 안전모: 노란색                    │
│     ✅ 보안경: 착용                      │
│     ❌ 장갑: 미착용                      │
│     ✅ 안전화: 착용                      │
│                                         │
├─────────────────────────────────────────┤
│  [관리자모드] [설정] [배경학습] [닫기]  │
└─────────────────────────────────────────┘
```

### 7.2 얼굴 인식 기능

#### 자동 인식
- 등록된 얼굴 감지 시 자동 식별
- 이름, 사원번호, 부서 표시
- 출입 시간 자동 기록

#### 미등록 얼굴
- "미등록 직원" 표시
- 관리자 모드에서 등록 가능

### 7.3 보호구 착용 감지

#### 실시간 감지 항목
1. **안전모**
   - 착용 여부: ✅/❌
   - 색상: 노란색, 흰색, 빨간색 등

2. **보안경/안경**
   - 착용 여부: ✅/❌

3. **장갑**
   - 착용 여부: ✅/❌

4. **안전화**
   - 착용 여부: ✅/❌

5. **작업복**
   - 색상: 파란색, 회색 등

#### 규정 위반 경고
보호구 미착용 시:
- ⚠️ 경고 메시지 표시
- 📸 증거 사진 자동 저장
- 📝 위반 기록 저장

### 7.4 배경 학습 기능 (NEW v1.9.1)

배경 학습으로 인식 정확도 향상:

#### 1. 배경 학습 시작
```
거울보기 → [배경 학습] 클릭
```

#### 2. 촬영 과정
```
3초 카운트다운
  ↓
3... 2... 1... 촬영!
  ↓
10장 자동 촬영 (2초 간격)
  ↓
썸네일 미리보기 (2행 × 5열)
  ↓
[배경 학습하기] 클릭
```

#### 3. 학습 완료
- 배경 데이터 저장
- 인식 정확도 향상

---

## 8. 안전교육 관리

### 8.1 안전교육 화면

메인 패널 → **[안전교육]** 클릭

#### 교육 진행 과정
```
1. 포스터 선택
   ↓
2. 포스터 표시 (전체 화면)
   ↓
3. 서명 요청
   ↓
4. OCR 인식
   ↓
5. 사진 촬영
   ↓
6. 기록 저장
```

### 8.2 포스터 관리

#### 포스터 추가
1. `safety_posters/` 디렉토리에 이미지 파일 복사
2. 지원 형식: JPG, PNG
3. 권장 크기: 1920x1080 이상

#### 포스터 선택
- 좌/우 화살표로 선택
- 미리보기 화면 표시
- [선택] 버튼으로 확정

### 8.3 서명 인식

#### 서명 입력
1. 서명 영역에 이름 작성
2. 한글, 영문 모두 가능
3. 크고 명확하게 작성

#### OCR 인식
- EasyOCR 자동 인식
- 인식 결과 표시
- 수정 가능

### 8.4 교육 기록

자동 저장 항목:
- 교육 날짜/시간
- 참여자 이름 (서명)
- 포스터 종류
- 증빙 사진
- 얼굴 인식 정보 (선택)

조회:
```
안전교육 → [교육 이력] → 날짜/이름 검색
```

---

## 9. 얼굴 인식 시스템

### 9.1 얼굴 등록

#### 등록 절차 (관리자)
1. **거울보기 → 우클릭 → [관리자 모드 On]**
2. **비밀번호 입력**: admin (기본값)
3. **[얼굴 등록] 클릭**
4. **정보 입력**:
   ```
   이름: 홍길동
   사원번호: 2025001
   부서: 생산부
   ```
5. **[촬영 시작]**
   - 정면 응시
   - 10장 자동 촬영
   - 다양한 각도 권장
6. **[등록 완료]**

#### 등록 팁
- ✅ 밝은 조명
- ✅ 정면 응시
- ✅ 안경 착용/미착용 모두 촬영
- ❌ 마스크 착용 X
- ❌ 어두운 환경 X

### 9.2 얼굴 삭제

1. **관리자 모드 → [얼굴 관리]**
2. **직원 목록**에서 선택
3. **[삭제] 클릭**
4. **확인**

### 9.3 인식 설정

**환경 설정 → 얼굴 인식**

| 설정 항목 | 설명 | 기본값 |
|----------|------|--------|
| 신뢰도 임계값 | 인식 정확도 기준 | 0.6 |
| 얼굴 크기 최소값 | 감지할 최소 크기 | 30 |
| 다중 얼굴 인식 | 여러 얼굴 동시 인식 | ON |
| 인식 주기 | 프레임 처리 간격 | 2프레임 |

### 9.4 출입 기록

얼굴 인식 시 자동 기록:
- 입실 시간
- 퇴실 시간
- 체류 시간
- 보호구 착용 여부

조회:
```
메인 패널 → 설정 → 출입 기록
→ 날짜/이름 검색
```

내보내기:
```
Excel (xlsx), CSV 형식
```

---

## 10. 보호구 감지

### 10.1 감지 원리

#### AI 객체 인식
- **YOLOv5 기반**
- **실시간 처리**: 30fps
- **정확도**: 평균 85% 이상

#### 감지 항목
1. 안전모 (Helmet)
2. 보안경 (Goggles/Glasses)
3. 장갑 (Gloves)
4. 안전화 (Safety Shoes)
5. 작업복 (Uniform)

### 10.2 색상 인식

#### 안전모 색상
- 🟡 노란색: 일반 작업자
- ⚪ 흰색: 관리자/감독
- 🔴 빨간색: 안전 관리자
- 🔵 파란색: 전기 작업자

#### 작업복 색상
- 자동 색상 감지
- 부서별 구분 가능

### 10.3 규정 설정

**환경 설정 → 보호구 설정**

```
필수 보호구 선택:
☑ 안전모 (필수)
☑ 보안경 (필수)
☐ 장갑 (선택)
☑ 안전화 (필수)
```

### 10.4 위반 처리

#### 자동 처리
1. 미착용 감지
2. ⚠️ 경고 표시 (3초)
3. 📸 증거 사진 저장
4. 📝 위반 기록 생성

#### 기록 조회
```
설정 → 위반 기록
→ 날짜/이름/보호구 종류 검색
```

---

## 11. 출입 관리

### 11.1 출입 기록 자동 생성

얼굴 인식 시:
- **입실**: 첫 인식 시각
- **퇴실**: 마지막 인식 + 5분 후
- **재입실**: 퇴실 후 재인식

### 11.2 기록 조회

**설정 → 출입 관리 → 출입 기록**

#### 검색 옵션
- 기간: 날짜 범위
- 이름: 직원 이름
- 사원번호: 사원번호
- 부서: 부서명

#### 표시 정보
| 항목 | 내용 |
|------|------|
| 날짜 | 2025-11-06 |
| 이름 | 홍길동 |
| 사원번호 | 2025001 |
| 입실 시각 | 08:30:15 |
| 퇴실 시각 | 17:45:32 |
| 체류 시간 | 9시간 15분 |
| 보호구 | 안전모(○), 보안경(○), 장갑(×) |

### 11.3 통계

**설정 → 출입 관리 → 통계**

- 일일 출입 인원
- 평균 체류 시간
- 보호구 착용률
- 부서별 통계

### 11.4 내보내기

```
[내보내기] 클릭
→ Excel (xlsx) 또는 CSV 선택
→ 저장 위치 지정
```

---

## 12. 도면 뷰

### 12.1 도면 뷰 화면

메인 패널 → **[도면 뷰]** 클릭

#### 화면 구성
```
┌─────────────────────────────────────┐
│     현장 도면 + 센서 위치           │
├─────────────────────────────────────┤
│                                     │
│         [도면 이미지]               │
│                                     │
│    🔴 센서1 (CO₂: 450ppm)          │
│    🟢 센서2 (O₂: 20.9%)            │
│    🟢 센서3 (H₂S: 0ppm)            │
│                                     │
└─────────────────────────────────────┘
```

### 12.2 도면 등록

#### 도면 파일 준비
1. 현장 도면 이미지 (JPG, PNG)
2. 권장 크기: 1920x1080 이상
3. 파일 저장: `blueprints/` 디렉토리

#### 도면 선택
```
도면 뷰 → [도면 설정]
→ 이미지 파일 선택
→ [확인]
```

### 12.3 센서 위치 설정

#### 위치 지정
1. **도면 뷰 → [편집 모드]**
2. **센서 아이콘 드래그**
3. **도면 위 적절한 위치에 배치**
4. **[저장]**

#### 센서 정보 표시
- 센서 ID
- 센서 종류
- 현재 값
- 경보 상태 (색상)

### 12.4 실시간 업데이트

- 센서 값 자동 갱신 (1초마다)
- 경보 상태 색상 변경
- 클릭 시 상세 정보 표시

---

# 3부. 고급 기능

*(계속...)*

---

## 13. 환경 설정

### 13.1 환경 설정 화면

메인 패널 → **[환경 설정]** 클릭

#### 설정 카테고리
```
┌─────────────────────────────┐
│  환경 설정                   │
├─────────────────────────────┤
│  [일반]                      │
│  [카메라]                    │
│  [센서]                      │
│  [얼굴 인식]                 │
│  [보호구]                    │
│  [안전교육]                  │
│  [알림]                      │
│  [백업]                      │
└─────────────────────────────┘
```

### 13.2 일반 설정

| 설정 | 설명 | 기본값 |
|------|------|--------|
| 프로그램 이름 | 표시될 이름 | GARAMe MANAGER |
| 자동 시작 | 부팅 시 자동 실행 | OFF |
| 와치독 | 자동 재시작 | ON |
| 언어 | 인터페이스 언어 | 한국어 |
| 테마 | 화면 테마 | 라이트 |

### 13.3 카메라 설정

| 설정 | 설명 | 기본값 |
|------|------|--------|
| 카메라 번호 | 사용할 카메라 | 0 |
| 해상도 | 카메라 해상도 | 1280x720 |
| FPS | 프레임 레이트 | 30 |
| 상하 반전 | 상하 뒤집기 | OFF |
| 좌우 반전 | 좌우 뒤집기 | OFF |

### 13.4 센서 설정

| 설정 | 설명 | 기본값 |
|------|------|--------|
| TCP 포트 | 센서 수신 포트 | 9000 |
| 타임아웃 | 연결 타임아웃(초) | 30 |
| 재연결 간격 | 재연결 시도 간격(초) | 10 |
| 경보 소리 | 경보 알림음 | ON |

### 13.5 얼굴 인식 설정

| 설정 | 설명 | 기본값 |
|------|------|--------|
| 얼굴 인식 활성화 | ON/OFF | ON |
| 신뢰도 임계값 | 0.5 ~ 0.9 | 0.6 |
| 얼굴 크기 최소값 | 픽셀 | 30 |
| 다중 얼굴 인식 | ON/OFF | ON |

### 13.6 설정 저장

설정 변경 후:
1. **[저장]** 클릭
2. 프로그램 재시작 (필요시)

설정 파일: `config.conf`

---

## 14. 데이터 관리

### 14.1 데이터 저장 위치

```
1.9.1/
├── logs/              # 로그 파일
│   ├── app.log
│   └── sensor.log
├── captures/          # 캡처 이미지
│   ├── 20251106_083015.jpg
│   └── ...
├── safety_photos/     # 안전교육 사진
│   ├── 20251106_홍길동.jpg
│   └── ...
├── face_db/          # 얼굴 데이터
│   ├── 홍길동_2025001/
│   └── ...
└── blueprint_data/   # 도면 데이터
```

### 14.2 로그 관리

#### 로그 파일
- `logs/app.log`: 프로그램 로그
- `logs/sensor.log`: 센서 데이터 로그
- `logs/watchdog.log`: 와치독 로그

#### 로그 보기
```bash
# 최근 100줄
tail -n 100 logs/app.log

# 실시간 감시
tail -f logs/app.log
```

#### 로그 정리
```bash
# 30일 이상 로그 삭제
find logs/ -name "*.log.*" -mtime +30 -delete
```

### 14.3 데이터 백업

자동 백업 설정:
```
환경 설정 → 백업
→ 자동 백업: ON
→ 백업 주기: 매일 / 매주 / 매월
→ 보관 기간: 30일
```

수동 백업:
```
환경 설정 → 백업 → [지금 백업]
```

백업 위치: `backups/backup_YYYYMMDD/`

### 14.4 데이터 삭제

**주의**: 삭제된 데이터는 복구할 수 없습니다!

```
환경 설정 → 데이터 관리
→ [오래된 데이터 삭제]
→ 기간 선택 (30일 / 60일 / 90일)
→ [삭제 실행]
```

---

## 15. 백업 및 복원

### 15.1 전체 백업

#### 백업 생성
```bash
cd ~/Desktop/프로그램/manager
tar -czf garame_backup_$(date +%Y%m%d).tar.gz 1.9.1/
```

#### 백업 내용
- 설정 파일 (config.conf)
- 얼굴 데이터 (face_db/)
- 안전교육 사진 (safety_photos/)
- 도면 데이터 (blueprint_data/)
- 로그 (logs/)

### 15.2 선택적 백업

#### 얼굴 데이터만
```bash
tar -czf face_db_backup_$(date +%Y%m%d).tar.gz face_db/
```

#### 설정 파일만
```bash
cp config.conf config.conf.backup_$(date +%Y%m%d)
```

### 15.3 복원

#### 전체 복원
```bash
cd ~/Desktop/프로그램/manager
tar -xzf garame_backup_YYYYMMDD.tar.gz
```

#### 부분 복원
```bash
# 얼굴 데이터만
tar -xzf face_db_backup_YYYYMMDD.tar.gz

# 설정 파일만
cp config.conf.backup_YYYYMMDD config.conf
```

---

## 16. 자동 시작 설정

### 16.1 자동 시작 방법

#### 방법 1: 사용자 자동 시작 (권장)
```bash
cd ~/Desktop/프로그램/manager/1.9.1
./setup_autostart.sh
# 옵션 선택: 1
```

#### 방법 2: systemd 시스템 서비스
```bash
./setup_autostart.sh
# 옵션 선택: 2
```

#### 방법 3: systemd 사용자 서비스
```bash
./setup_autostart.sh
# 옵션 선택: 3
```

### 16.2 자동 시작 확인

```bash
# 사용자 자동 시작
ls ~/.config/autostart/garame-manager.desktop

# systemd 서비스
sudo systemctl status garame-manager.service
```

### 16.3 자동 시작 해제

```bash
# 사용자 자동 시작
rm ~/.config/autostart/garame-manager.desktop

# systemd 서비스
sudo systemctl disable garame-manager.service
```

---

# 4부. 문제 해결

## 17. 일반적인 문제

### 17.1 프로그램이 시작되지 않음

#### 증상
```
./run.sh 실행 시 오류
```

#### 해결
```bash
# 1. 가상환경 확인
ls ~/venvs/garame

# 2. 가상환경 재생성
./install.sh

# 3. 의존성 확인
source ~/venvs/garame/bin/activate
python check_dependencies.py
```

### 17.2 카메라가 인식되지 않음

#### 증상
```
카메라를 찾을 수 없습니다
```

#### 해결
```bash
# 1. 카메라 장치 확인
ls -l /dev/video*

# 2. 권한 확인
sudo usermod -a -G video $USER
sudo reboot

# 3. 카메라 번호 변경
환경 설정 → 카메라 → 카메라 번호 (0, 1, 2 시도)
```

### 17.3 센서 연결 실패

#### 증상
```
센서 연결 시간 초과
```

#### 해결
```bash
# 1. 네트워크 확인
ping <센서 IP>

# 2. 포트 확인
netstat -an | grep 9000

# 3. 방화벽 확인
sudo ufw allow 9000/tcp

# 4. 센서 프로그램 재시작
```

### 17.4 얼굴 인식 정확도 낮음

#### 원인
- 조명 부족
- 카메라 각도 불량
- 얼굴 데이터 부족

#### 해결
1. **조명 개선**
   - 밝은 환경
   - 역광 피하기

2. **카메라 위치 조정**
   - 정면 응시 가능한 위치
   - 눈높이 맞추기

3. **얼굴 데이터 추가**
   - 다양한 각도 촬영
   - 안경 착용/미착용 모두

4. **배경 학습 실행**
   - 거울보기 → 배경 학습
   - 10장 배경 사진 촬영

### 17.5 한글 입력이 안 됨

#### 증상
```
자음/모음이 조합되지 않고 순서대로 입력됨
예: "홍길동" → "ㅎㅗㅇㄱㅣㄹㄷㅗㅇ"
```

#### 해결
```bash
# 1. xdotool 설치 확인
which xdotool

# 2. xdotool 설치
sudo apt install -y xdotool

# 3. ibus-hangul 설정
ibus-setup
# Korean - Hangul 추가

# 4. 프로그램 재시작
```

---

## 18. 오류 메시지

### 18.1 "Permission denied"

#### 원인
- 실행 권한 없음
- 카메라 권한 없음

#### 해결
```bash
# 스크립트 실행 권한
chmod +x run.sh install.sh

# 카메라 권한
sudo usermod -a -G video $USER
sudo reboot
```

### 18.2 "ModuleNotFoundError"

#### 원인
- Python 패키지 미설치

#### 해결
```bash
source ~/venvs/garame/bin/activate
pip install -r requirements.txt
```

### 18.3 "Image' object has no attribute 'Resampling'"

#### 원인
- Pillow 버전 불일치

#### 해결
```bash
source ~/venvs/garame/bin/activate
pip install --upgrade Pillow
```

### 18.4 "Connection refused"

#### 원인
- 센서 프로그램 미실행
- 방화벽 차단

#### 해결
```bash
# 센서 시작
# (센서 PC에서 실행)

# 방화벽 허용
sudo ufw allow 9000/tcp
```

---

## 19. FAQ

### Q1: 여러 대의 센서를 연결할 수 있나요?
**A**: 네, 최대 10대까지 동시 연결 가능합니다.
```
환경 설정 → 센서 → [센서 추가]
```

### Q2: 오프라인 환경에서 사용할 수 있나요?
**A**: 네, 완전 오프라인 사용 가능합니다.
- 얼굴 인식: 로컬 처리
- OCR: 로컬 처리
- 센서 데이터: 로컬 네트워크

### Q3: 데이터는 얼마나 보관되나요?
**A**: 설정에 따라 조정 가능합니다.
```
환경 설정 → 데이터 관리
→ 보관 기간: 30일 / 60일 / 90일 / 무제한
```

### Q4: 다른 PC에서 모니터링할 수 있나요?
**A**: 네, 네트워크를 통한 원격 접속 가능합니다.
```
웹 브라우저 → http://<서버IP>:5000
```

### Q5: 얼굴 데이터는 안전한가요?
**A**: 네, 로컬에만 저장되며 외부 전송되지 않습니다.
- 저장 위치: `face_db/` (로컬)
- 암호화: AES-256 (선택)
- 접근 권한: 관리자만

### Q6: 여러 카메라를 동시에 사용할 수 있나요?
**A**: 현재 버전은 1개 카메라만 지원합니다.
다중 카메라는 v2.0에서 지원 예정입니다.

### Q7: 성능이 느려요.
**A**: 다음을 시도해보세요:
1. 카메라 해상도 낮추기 (640x480)
2. FPS 낮추기 (15fps)
3. 배경 학습 실행
4. Cython 빌드 사용 (10-30% 향상)

### Q8: 보호구 인식 정확도를 높이려면?
**A**:
1. 밝은 조명 사용
2. 카메라 위치 조정 (정면, 전신)
3. 배경 학습 실행
4. 고해상도 카메라 사용 (720p 이상)

---

## 20. 기술 지원

### 20.1 로그 수집

문제 발생 시 다음 로그를 수집하세요:

```bash
cd ~/Desktop/프로그램/manager/1.9.1

# 로그 수집
tar -czf garame_logs_$(date +%Y%m%d_%H%M%S).tar.gz logs/

# 시스템 정보
{
    echo "=== 시스템 정보 ==="
    lsb_release -a
    uname -a
    python3 --version

    echo ""
    echo "=== 카메라 정보 ==="
    ls -l /dev/video*

    echo ""
    echo "=== 네트워크 정보 ==="
    ifconfig
    netstat -an | grep 9000
} > system_info.txt
```

### 20.2 연락처

- **이메일**: support@garame.com
- **전화**: 1234-5678
- **GitHub**: https://github.com/garame/manager/issues

### 20.3 버그 리포트

GitHub Issues에 다음 정보 포함:

1. **환경 정보**
   - Ubuntu 버전
   - Python 버전
   - GARAMe MANAGER 버전

2. **문제 설명**
   - 증상
   - 재현 방법
   - 예상 동작

3. **첨부 파일**
   - 로그 파일
   - 스크린샷
   - 설정 파일

---

# 부록

## 부록 A. 단축키 목록

| 단축키 | 기능 |
|--------|------|
| F1 | 센서 모니터링 |
| F2 | 거울보기 |
| F3 | 안전교육 |
| F4 | 도면 뷰 |
| F5 | 환경 설정 |
| F11 | 전체 화면 |
| ESC | 이전 화면 / 종료 |
| Ctrl+S | 설정 저장 |
| Ctrl+Q | 프로그램 종료 |

## 부록 B. 파일 구조

```
1.9.1/
├── main.py                 # 메인 프로그램
├── watchdog.py             # 와치독
├── config.conf             # 설정 파일
├── requirements.txt        # 의존성 목록
├── run.sh                  # 실행 스크립트
├── install.sh              # 설치 스크립트
├── setup_autostart.sh      # 자동 시작 설정
├── build_secure.sh         # Cython 빌드
├── src/                    # 소스 코드
│   └── tcp_monitor/
│       ├── ui/             # UI 모듈
│       ├── sensor/         # 센서 모듈
│       └── utils/          # 유틸리티
├── logs/                   # 로그 파일
├── face_db/                # 얼굴 데이터
├── captures/               # 캡처 이미지
├── safety_photos/          # 안전교육 사진
├── safety_posters/         # 안전교육 포스터
├── blueprints/             # 도면 이미지
├── blueprint_data/         # 도면 데이터
└── wheels/                 # 오프라인 패키지
```

## 부록 C. 업데이트 이력

### v1.9.1 (2025-11-06)
- 배경 학습 기능 추가
- 한글 입력 개선
- 와치독 안정성 강화
- Cython 빌드 지원
- 시스템 최적화 기능

### v1.9.0 (2025-11-05)
- 카메라 상하좌우 반전 기능
- 센서 연결 안정성 개선
- UI 개선 (패널 헤더)

### v1.8.9
- 와치독 기능 추가
- 자동 재시작

### v1.8.6
- 초기 릴리스

---

**문서 끝**

Copyright © 2025 GARAMe Project
All Rights Reserved.

---

**버전 이력**
- v1.0.0 (2025-11-06): 초판 작성
